<html lang="en">
<head>
    <title>Kiddo</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="description" content="">
    <meta name="author" content="">
    <link rel="icon" href="favicon.ico">

    <!-- Bootstrap core CSS -->
    <link href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-9aIt2nRpC12Uk9gS9baDl411NQApFmC26EwAOH8WgZl5MYYxFfc+NcPb1dKGj7Sk" crossorigin="anonymous">
    <link rel="stylesheet" href="https://code.jquery.com/ui/1.12.1/themes/smoothness/jquery-ui.css">

    <!-- Custom styles for this template -->
    <style>	
		
		body {
 			 /*background-image: url("Resources/Backgrounds/FrankLogo.png"); */
 			 background-color: #000000;
			}
		
		body, html {width: 100%; height: 100%; margin: 0; padding: 0}
				.row-container {display: flex; width: 100%; height: 100%; flex-direction: column; background-color: blue; overflow: hidden;}
				.first-row {background-color: lime; }
				.second-row { flex-grow: 1; border: none; margin: 0; padding: 0; }
		
      	
		.video_wrapper {
			position: relative;
			padding-bottom: 56.25%; /* 16:9, for an aspect ratio of 1:1 change to this value to 100% */ 
			}
			iframe{
			position: absolute;
			top: 0;
			left: 0;
			width: 100%;
			height: 100%;
		}
		
		
		.container {
            max-width: 1600px;
        }
		
		

        .border-top { border-top: 1px solid #e5e5e5; }
        .border-bottom { border-bottom: 1px solid #e5e5e5; }
        .border-top-gray { border-top-color: #adb5bd; }

        .box-shadow { box-shadow: 0 .25rem .75rem rgba(0, 0, 0, .05); }

        .lh-condensed { line-height: 1.25; }

        /* Bootstrap Overrides */
        /* -- Place dots between inline-list-items */
        ul li:after { content: " \00b7"; }
        ul li:last-child:after { content: ""; }
        .list-inline-item:not(:last-child) { margin-right: 0; }

        /* -- Override certain badge transitions */
        #feedback-publish, #feedback-subscribe, #feedback-subscriptions {
            transition: none;
        }

        /* -- Special coloring for subscriptions/li */
        #subscriptions li.list-group-item {
            background: #000000
        }

        /* Placeholder Colors */
        .form-control::-webkit-input-placeholder {
            color: #999;
        }
        .form-control:-moz-placeholder {
            color: #999;
        }
        .form-control::-moz-placeholder {
            color: #999;
        }
        .form-control::placeholder {
            color: #999;
        }
        .form-control:-ms-input-placeholder {
            color: #999;
        }
				
				
    </style>
</head>
	
		
		
	
<body class="bg-black text-light" onload="Connect()" id="trigger">
    <!-- Github Corner http://tholman.com/github-corners/ -->
    <a href="https://github.com/jnovack/mqtt-websocket/" class="github-corner" aria-label="View source on GitHub"><svg width="80" height="80" viewBox="0 0 250 250" style="fill:#fff; color:#151513; position: absolute; top: 0; border: 0; left: 0; transform: scale(-1, 1);" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a><style>.github-corner:hover .octo-arm{animation:octocat-wave 560ms ease-in-out}@keyframes octocat-wave{0%,100%{transform:rotate(0)}20%,60%{transform:rotate(-25deg)}40%,80%{transform:rotate(10deg)}}@media (max-width:500px){.github-corner:hover .octo-arm{animation:none}.github-corner .octo-arm{animation:octocat-wave 560ms ease-in-out}} </style>
	

	
    <!-- Main Content -->
    <div class="container">			
        <div class="row py-5">
            <div class="col-md-2 d-flex justify-content-end col-xl-1">
              <!--  <img class="d-inline mx-auto mb-4"
                    src="https://raw.githubusercontent.com/mqtt/mqttorg-graphics/6e24cee95735f7bf04c1a11f7ebf246801f586a2/mqtticon.svg"
                    alt="" width="72" height="72">-->
            </div>
        </div>

        <div class="text-center col-xl-12">
                <img src="./Resources/KiddoTitle.gif" width="50%" alt="Kiddo Title" border="0">

                <h1></h1>
        </div>  

        <br></br><br></br>
					
		<div class = "row">
			
			<div class="col col-12">
				<div class="video_wrapper">
					<iframe src="https://player.twitch.tv/?channel=frankroomone&parent=frankwomencollective.github.io&muted=false" allowfullscreen class="second-row"  title="Living Room"></iframe>
				</div>
			</div>				
				
		</div>
					
		<div class="text-center col-xl-12">
		
		
	<br></br><br></br><br></br><br></br><br></br>
	<br></br><br></br><br></br><br></br><br></br>
    <br></br><br></br><br></br><br></br><br></br>
    <br></br><br></br><br></br><br></br><br></br>

  <h1>choose your token pet!</h1>
		
	<br></br>

  <table class="col-xl-12"> 
		  <td>
			<a href="/Pages/Room1.html" target="_self">
		  	<img src="./Resources/Icons/Tokens/khalitoken.png" alt="Room 1" border="0" width = "100%">
		  	</a>
		</td>
		<td>
			<a href="/Pages/Room2.html" target="_self">
		  	<img src="./Resources/Icons/Tokens/kelseytoken.png" alt="Room 2" border="0" width = "100%">
		  	</a>
		</td>
		 <td> 
			<a href="/Pages/Room3.html" target="_self">
		  	<img src="./Resources/Icons/Tokens/ericatoken.png" alt="Room 3" border="0" width = "100%">
		  	</a>
		</td>
		<td>
			<a href="/Pages/Room4.html" target="_self">
	  		<img src="./Resources/Icons/Tokens/robertotoken.png" alt="Room 4" border="0" width = "100%">
		  	</a>
		</td>
		<td>
		  	<a href="/Pages/Room5.html" target="_self">
	  		<img src="./Resources/Icons/Tokens/alexatoken.png" alt="Room 5" border="0" width = "100%">
			</a>
		</td>
		</table>
		
		
        <footer class="my-5 pt-5 text-muted text-center text-small">
        </footer>
    </div>






    <!-- JavaScript
         ==================================================
         Placed at the end of the document so the pages load faster
         -->
    <!-- JQuery -->
    <script src="https://code.jquery.com/jquery-3.2.1.min.js"
        integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4=" crossorigin="anonymous"></script>
    <!-- JQuery UI -->
    <script src="https://code.jquery.com/ui/1.12.1/jquery-ui.js"></script>

    <!-- Bootstrap -->
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/js/bootstrap.min.js"
        integrity="sha384-OgVRvuATP1z7JjHLkuOU7Xw704+h835Lr+6QL9UvYjZE3Ipu6Tp75j7Bh/kR0JKI"
        crossorigin="anonymous"></script>

    <!-- Font Awesome -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.13.1/js/all.min.js"></script>

    <!-- MQTT Websockets Library -->
    <!--   Documentation: https://www.eclipse.org/paho/files/jsdoc/Paho.MQTT.Client.html -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/paho-mqtt/1.0.1/mqttws31.js" type="text/javascript"></script>

    <!-- Additional Display Libraries -->
    <!-- <script src="https://unpkg.com/@popperjs/core@2"></script> -->

    <script>
        // Bootstrap form submission prevention
        //   We want to use forms for display and function, NOT for submission.
        (function () {
            'use strict';
            window.addEventListener('load', function () {
                // Fetch all the forms we want to apply custom Bootstrap validation styles to
                var forms = document.getElementsByClassName('needs-validation');

                // Loop over them and prevent submission
                var validation = Array.prototype.filter.call(forms, function (form) {
                    form.addEventListener('submit', function (event) {
                        if (form.checkValidity() === false) {
                            return false;
                        }
                        event.preventDefault();
                        event.stopPropagation();
                        }, false);
                });
            }, false);
        })();
    </script>
    <script>
        // Helper functions

        /**
        * @return {string}
        */
        function makeid(length) {
            var result = '';
            var characters = 'abcdefghijklmnopqrstuvwxyz0123456789';
            var charactersLength = characters.length;
            for (var i = 0; i < length; i++) {
                result += characters.charAt(Math.floor(Math.random() * charactersLength));
            }
            return result;
        }
        $("#clientid").attr("placeholder", makeid(8));

        /**
        * @see http://stackoverflow.com/q/7616461/940217
        * @return {number}
        */
        String.prototype.hashCode = function () {
            if (Array.prototype.reduce) {
                return this.split("").reduce(function (a, b) { a = ((a << 5) - a) + b.charCodeAt(0); return a & a }, 0);
            }
            var hash = 0;
            if (this.length === 0) return hash;
            for (var i = 0; i < this.length; i++) {
                var character = this.charCodeAt(i);
                hash = ((hash << 5) - hash) + character;
                hash = hash & hash; // Convert to 32bit integer
            }
            return hash;
        }
    </script>
    <script>
        // Initialization fuctions

        $('#connect').click(function () {
            $('#connect').removeClass('btn-success').addClass('btn-disabled');
            Connect();
            return false;
        });
        $('#disconnect').click(function () {
            Disconnect();
            return false;
        });
        $('#publish').click(function () {
            Publish()
            return false;
        });
        $('#subscribe').click(function () {
            Subscribe();
            return false;
        });
        $('#header-publish').on('click', function() {
            $('#panel-publish').slideToggle();
        })
        $('#header-subscribe').on('click', function() {
            $('#panel-subscribe').slideToggle();
        })
        $('#clear').click(function () {
            $('#subscriptions').empty();
        });
    </script>
    <script>
        // "Public" functions //
		
		//Unique ID for each USER//
		var userID = makeid(8);
		
		
        // Connect button press
        function Connect() {
			console.log("connect");
            var cleanSession = true;
            var useSSL = true;
            var endpoint = 'mqtt.frankuserinterface.live:8033';
            var username = "";
            var password = "";
            var clientid = "";

            uri = endpoint.split(/:/g);
            console.log("connecting to " + uri[0] + ":" + parseInt(uri[1]) + " using a " + (cleanSession ? "clean" : "persistant") + " session " + (username ? "with" : "without") + " authentication as " + clientid);

            $('#connection-status').removeClass('badge-disabled badge-success badge-danger badge-warning badge-primary badge-info badge-dark').addClass('badge-info');
            mqtt = new Paho.MQTT.Client(uri[0], parseInt(uri[1]), clientid);
            var options = {
                useSSL: useSSL,
                timeout: 3,
                cleanSession: cleanSession,
                onSuccess: onConnectionSuccess,
                onFailure: onConnectionFailure,

            };
            if (username != "")
                options.userName = username;
            if (password != "")
                options.password = password;

            mqtt.onConnectionLost = onConnectionLost;
            mqtt.onMessageArrived = onMessageArrived;
            mqtt.onMessageDelivered = onMessageSuccess;

            mqtt.connect(options);
        }

        // Disconnect button press
        function Disconnect() {
            mqtt.disconnect();
        }

        // Publish button press
        function Publish() {
			
            message = new Paho.MQTT.Message($('#publish-message').val());
			message.destinationName = $('#publish-topic').val();
            message.qos = parseInt($('#publish-qos').val());
            message.retained = $('#publish-retain').is(':checked');
            mqtt.send(message);
        }
		
		// Publish button press
        function PublishMessage(newMessage, newTopic) {
			console.log(userID);
            message = new Paho.MQTT.Message( userID + "/" + newMessage);
			message.destinationName = newTopic;
            message.qos = 0;
            message.retained = $('#publish-retain').is(':checked');
            mqtt.send(message);
        }

        // Subscribe button press
        function Subscribe() {
            mqtt.subscribe($('#subscribe-topic').val(), { qos: parseInt($('#subscribe-qos').val()), onSuccess: onSubscribeSuccess, onFailure: onSubscribeFailure });
        }
    </script>
    <script>
        // "Private" functions

        function onMessageSuccess(obj) {
            $("#feedback-publish").effect("highlight", {color: '#28a745'}, 3000);
            // $('#publish-message').addClass('is-valid');
        }
        function onSubscribeSuccess(obj) {
            $("#feedback-subscribe").effect("highlight", {color: '#28a745'}, 3000);
            // $('#subscribe-topic').addClass('is-valid');
        }
        function onSubscribeFailure(obj) {
            $('#subscribe-topic').addClass('is-invalid');
            $('#subscribe-error').html(obj.errorMessage);
        }
        function onConnectionSuccess(obj) {
            $('#connect').addClass('d-none');
            $('#disconnect').removeClass('d-none');
            $('#endpoint').attr('disabled', true);
            $('#use-ssl').attr('disabled', true);
            $('#username').attr('disabled', true);
            $('#password').attr('disabled', true);
            $('#clientid').attr('disabled', true);
            $('#clean-session').attr('disabled', true);
            $('#connect').removeClass('btn-disabled').addClass('btn-success');
            $('#publish').attr('disabled', false).removeClass('btn-secondary').addClass('btn-primary');
            $('#subscribe').attr('disabled', false).removeClass('btn-secondary').addClass('btn-primary');
            $('#connection-status').removeClass('badge-disabled badge-success badge-danger badge-warning badge-primary badge-info badge-dark').addClass('badge-success');

            mqtt.subscribe('test', { qos: 0 });
        }
        function onConnectionFailure(obj) {
            onConnectionLost(obj);
        }
        function onConnectionLost(obj) {
            if (obj.errorCode == 0) {
                $('#connection-status').removeClass('badge-disabled badge-success badge-danger badge-warning badge-primary badge-info badge-dark').addClass('badge-disabled');
            } else {
                $('#connection-status').removeClass('badge-disabled badge-success badge-danger badge-warning badge-primary badge-info badge-dark').addClass('badge-danger');
            }
            $('#disconnect').addClass('d-none');
            $('#connect').removeClass('d-none');
            $('#endpoint').attr('disabled', false);
            $('#use-ssl').attr('disabled', false);
            $('#username').attr('disabled', false);
            $('#password').attr('disabled', false);
            $('#clientid').attr('disabled', false);
            $('#clean-session').attr('disabled', false);
            $('#publish').attr('disabled', true).removeClass('btn-primary').addClass('btn-secondary');
            $('#subscribe').attr('disabled', true).removeClass('btn-primary').addClass('btn-secondary');
        }
        function onMessageArrived(obj) {
            $("#feedback-subscriptions").stop().css("background-color", "");  // Multiple messages could come in, reset element if still animating
            $("#feedback-subscriptions").effect("highlight", {color: '#28a745'}, 3000);
            if ($('#topic-' + obj.destinationName.hashCode()).length) {
                // Update
                $('#topic-' + obj.destinationName.hashCode()).effect("highlight");
                $('#message-' + obj.destinationName.hashCode()).html(obj.payloadString);
            } else {
                // Add
                $('#subscriptions').append("<li id='topic-" + obj.destinationName.hashCode() +
                    "' class='list-group-item justify-content-between lh-condensed'><div class='row text-light'><div class='col-md-9'>" +
                    obj.destinationName +
                    "</div><div class='col-md-3' id='message-" +
                    obj.destinationName.hashCode() +
                    "'>" +
                    obj.payloadString +
                    "</div></div></li>"
                )
            }
        }
    </script>
</body>
</html>
